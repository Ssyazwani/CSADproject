<!DOCTYPE html>
<html lang="en">
<head>
<<<<<<< Updated upstream
  <meta charset="UTF-8">
  <title>Create Booking</title>
  <style>
=======
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create a Booking</title>
    <style>
>>>>>>> Stashed changes
    table {
      border-collapse: collapse;
      width: 100%;
    }
    th, td {
<<<<<<< Updated upstream
      border: 1px solid #aaa;
      text-align: center;
      padding: 6px;
=======
      border: 1px solid #444;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
      font-weight: bold;
>>>>>>> Stashed changes
    }
    .slot {
      cursor: pointer;
    }
<<<<<<< Updated upstream
    .slot.disabled {
      background: #ddd;
      pointer-events: none;
    }
    .slot.selected {
      background: lightgreen;
=======
    .slot.selected {
      background-color: #4caf50;
      color: white;
    }
    .slot.disabled {
      background-color: #ccc;
      cursor: not-allowed;
      color: red;
>>>>>>> Stashed changes
    }
  </style>
</head>

<body>

<form action="/createBooking" method="POST">

  <label>Facility:</label>
  <select id="facility">
    <option value="">-- Select Facility --</option>
    <option value="Tennis Court">Tennis Court</option>
    <option value="Basketball Court">Basketball Court</option>
    <option value="Futsal Court">Futsal Court</option>
    <option value="Badminton Court">Badminton Court</option>
  </select>

  <br><br>

  <label>Booking Date:</label>
  <input type="date" id="event-date" min="2026-01-01" max="2026-12-31">

  <!-- Hidden fields sent to backend -->
  <input type="hidden" name="selectedFacility" id="selectedFacility">
  <input type="hidden" name="selectedDate" id="selectedDate">
  <input type="hidden" name="selectedCourt" id="selectedCourt">
  <input type="hidden" name="selectedTime" id="selectedTime">

  <br><br>

  <table>
    <thead>
      <tr>
        <th>Facility</th>
        <th>Court</th>
        <th>09-10</th>
        <th>10-11</th>
        <th>11-12</th>
        <th>12-13</th>
        <th>13-14</th>
        <th>14-15</th>
        <th>15-16</th>
        <th>16-17</th>
        <th>17-18</th>
        <th>18-19</th>
        <th>19-20</th>
        <th>20-21</th>
      </tr>
    </thead>

    <tbody>
      <tr>
        <td rowspan="4" id="facility-cell">—</td>
        <td>Court 1</td>
        <td class="slot" data-court="Court 1" data-time="09:00 - 10:00"></td>
        <td class="slot" data-court="Court 1" data-time="10:00 - 11:00"></td>
        <td class="slot" data-court="Court 1" data-time="11:00 - 12:00"></td>
        <td class="slot" data-court="Court 1" data-time="12:00 - 13:00"></td>
        <td class="slot" data-court="Court 1" data-time="13:00 - 14:00"></td>
        <td class="slot" data-court="Court 1" data-time="14:00 - 15:00"></td>
        <td class="slot" data-court="Court 1" data-time="15:00 - 16:00"></td>
        <td class="slot" data-court="Court 1" data-time="16:00 - 17:00"></td>
        <td class="slot" data-court="Court 1" data-time="17:00 - 18:00"></td>
        <td class="slot" data-court="Court 1" data-time="18:00 - 19:00"></td>
        <td class="slot" data-court="Court 1" data-time="19:00 - 20:00"></td>
        <td class="slot" data-court="Court 1" data-time="20:00 - 21:00"></td>
      </tr>

      <tr>
        <td>Court 2</td>
        <td class="slot" data-court="Court 2" data-time="09:00 - 10:00"></td>
        <td class="slot" data-court="Court 2" data-time="10:00 - 11:00"></td>
        <td class="slot" data-court="Court 2" data-time="11:00 - 12:00"></td>
        <td class="slot" data-court="Court 2" data-time="12:00 - 13:00"></td>
        <td class="slot" data-court="Court 2" data-time="13:00 - 14:00"></td>
        <td class="slot" data-court="Court 2" data-time="14:00 - 15:00"></td>
        <td class="slot" data-court="Court 2" data-time="15:00 - 16:00"></td>
        <td class="slot" data-court="Court 2" data-time="16:00 - 17:00"></td>
        <td class="slot" data-court="Court 2" data-time="17:00 - 18:00"></td>
        <td class="slot" data-court="Court 2" data-time="18:00 - 19:00"></td>
        <td class="slot" data-court="Court 2" data-time="19:00 - 20:00"></td>
        <td class="slot" data-court="Court 2" data-time="20:00 - 21:00"></td>
      </tr>

      <tr>
        <td>Court 3</td>
        <td class="slot" data-court="Court 3" data-time="09:00 - 10:00"></td>
        <td class="slot" data-court="Court 3" data-time="10:00 - 11:00"></td>
        <td class="slot" data-court="Court 3" data-time="11:00 - 12:00"></td>
        <td class="slot" data-court="Court 3" data-time="12:00 - 13:00"></td>
        <td class="slot" data-court="Court 3" data-time="13:00 - 14:00"></td>
        <td class="slot" data-court="Court 3" data-time="14:00 - 15:00"></td>
        <td class="slot" data-court="Court 3" data-time="15:00 - 16:00"></td>
        <td class="slot" data-court="Court 3" data-time="16:00 - 17:00"></td>
        <td class="slot" data-court="Court 3" data-time="17:00 - 18:00"></td>
        <td class="slot" data-court="Court 3" data-time="18:00 - 19:00"></td>
        <td class="slot" data-court="Court 3" data-time="19:00 - 20:00"></td>
        <td class="slot" data-court="Court 3" data-time="20:00 - 21:00"></td>
      </tr>

      <tr>
        <td>Court 4</td>
        <td class="slot" data-court="Court 4" data-time="09:00 - 10:00"></td>
        <td class="slot" data-court="Court 4" data-time="10:00 - 11:00"></td>
        <td class="slot" data-court="Court 4" data-time="11:00 - 12:00"></td>
        <td class="slot" data-court="Court 4" data-time="12:00 - 13:00"></td>
        <td class="slot" data-court="Court 4" data-time="13:00 - 14:00"></td>
        <td class="slot" data-court="Court 4" data-time="14:00 - 15:00"></td>
        <td class="slot" data-court="Court 4" data-time="15:00 - 16:00"></td>
        <td class="slot" data-court="Court 4" data-time="16:00 - 17:00"></td>
        <td class="slot" data-court="Court 4" data-time="17:00 - 18:00"></td>
        <td class="slot" data-court="Court 4" data-time="18:00 - 19:00"></td>
        <td class="slot" data-court="Court 4" data-time="19:00 - 20:00"></td>
        <td class="slot" data-court="Court 4" data-time="20:00 - 21:00"></td>
      </tr>
    </tbody>
  </table>

  <br>
  <input type="submit" value="Book">

</form>

<script>
const facilitySelect = document.getElementById("facility");
const dateInput = document.getElementById("event-date");
const facilityCell = document.getElementById("facility-cell");

const hiddenFacility = document.getElementById("selectedFacility");
const hiddenDate = document.getElementById("selectedDate");
const hiddenCourt = document.getElementById("selectedCourt");
const hiddenTime = document.getElementById("selectedTime");

const slots = document.querySelectorAll(".slot");

// Disable slots initially
slots.forEach(s => s.classList.add("disabled"));

facilitySelect.addEventListener("change", update);
dateInput.addEventListener("change", update);

function update() {
  hiddenFacility.value = facilitySelect.value;
  hiddenDate.value = dateInput.value;
  facilityCell.textContent = facilitySelect.value || "—";

  if (!facilitySelect.value || !dateInput.value) return;

  fetch(`/getBookings?facility=${facilitySelect.value}&date=${dateInput.value}`)
    .then(res => res.json())
    .then(booked => {
      slots.forEach(slot => {
        const key = `${slot.dataset.court}-${slot.dataset.time}`;
        slot.classList.remove("selected");
        if (booked.includes(key)) {
          slot.classList.add("disabled");
          slot.textContent = "X";
        } else {
          slot.classList.remove("disabled");
          slot.textContent = "";
        }
      });
    });
}

slots.forEach(slot => {
  slot.addEventListener("click", () => {
    if (slot.classList.contains("disabled")) return;

    slots.forEach(s => s.classList.remove("selected"));
    slot.classList.add("selected");

    hiddenCourt.value = slot.dataset.court;
    hiddenTime.value = slot.dataset.time;
  });
});
</script>

</body>
</html>
